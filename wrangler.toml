# =============================================================================
# FILE: wrangler.toml
#
# DESCRIPTION:
# Configuration for the standalone, reusable session management worker.
# This worker is not intended to be public and will only be called by other
# workers via service bindings.
# =============================================================================

name = "divortio-session-worker"
main = "src/worker.mjs"
compatibility_date = "2025-08-15"

workers_dev = false
preview_urls = false
minify = true

[placement]
mode = "smart"

[observability]
enabled = true
head_sampling_rate = 1

# --- Environment Variables ---
[vars]
# Inactivity timeout for a session to be considered "expired" on the server-side.
SESSION_TIMEOUT_MS = 1800000 # 30 minutes

# --- Cookie Expiration Settings (in seconds) ---
# Default: 31,536,000 seconds (1 year)
# Used for cID, sID, and eID cookies to make them persistent on the client.
SESSION_COOKIE_EXPIRATION_SECONDS = 31536000

# Default: 31,536,000 seconds (1 year)
# Expiration for the browser fingerprint cookie.
FP_ID_EXPIRATION_SECONDS = 31536000

# Default: 31,536,000 seconds (1 year)
# Expiration for the Durable Object locator cookie.
DO_ID_EXPIRATION_SECONDS = 31536000


# --- Database Migrations ---
# This block tells Cloudflare to register SessionDO as a new class the
# first time this worker is deployed.
[[migrations]]
tag = "v1-initial-install"
new_sqlite_classes = ["SessionDO"]